# HW 'Тестирование Django-приложения'


## Задание:

Есть бекенд простого приложения с курсами и списком студентов. Вся логика для бекенда уже есть в заготовке, но совершенно нет тестов.

Вам необходимо написать тесты для текущей логики приложения.


## Описание задачи:

Заведите фикстуры:
- для api-client'а
- для фабрики курсов
- для фабрики студентов

В качестве библиотеки для фабрик используйте `model_bakery` (https://github.com/model-bakers/model_bakery).

Добавьте следующие тест-кейсы:

- проверка получения 1го курса (retrieve-логика)
  - создаем курс через фабрику
  - строим урл и делаем запрос через тестовый клиент
  - проверяем, что вернулся именно тот курс, который запрашивали
- проверка получения списка курсов (list-логика)
  - аналогично – сначала вызываем фабрики, затем делаем запрос и проверяем результат
- проверка фильтрации списка курсов по `id`
  - создаем курсы через фабрику, передать id одного курса в фильтр, проверить результат запроса с фильтром
- проверка фильтрации списка курсов по `name`
- тест успешного создания курса
  - здесь фабрика не нужна, готовим JSON-данные и создаем курс
- тест успешного обновления курса
  - сначала через фабрику создаем, потом обновляем JSON-данными
- тест успешного удаления курса


Все тесты должны явно проверять код возврата.

Не забывайте использовать декоратор `@pytest.mark.django_db`, чтобы тесты использовали базу.


## Подсказки

- `APIClient` в DRF является расширением Джанговского `Client`. Для того, чтобы передать GET-параметры в запросе, используйте аргумент `data`: https://docs.djangoproject.com/en/3.1/topics/testing/tools/#django.test.Client.get


## Документация

pytest: https://docs.pytest.org/en/stable/ 

pytest-django: https://pytest-django.readthedocs.io/en/latest/ 

тестирование DRF: https://www.django-rest-framework.org/api-guide/testing/


## Дополнительные задания (необязательные для выполнения)

### Ограничить число студентов на курсе

Добавьте валидацию на максимальное число студентов на курсе – 20. Подумайте, как протестировать это ограничение, не создавая 20 сущностей в базе данных.

__Подсказка:__ задайте максимальное число студентов в `settings.py`: `MAX_STUDENTS_PER_COURSE`. В тестах используйте `parametrize` и фикстуру `settings` (https://pytest-django.readthedocs.io/en/latest/helpers.html#settings), чтобы переопределить параметр.

Протестируйте как неудачный исход, так и успешный.
